<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creation of the interpolation Grid â€¢ agrometeoR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Creation of the interpolation Grid">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agrometeoR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmarking_example.html">Benchmarking example</a>
    </li>
    <li>
      <a href="../articles/gstat_integration_mlr.html">Integration of gstat into mlr</a>
    </li>
    <li>
      <a href="../articles/interpolation_grid_creation.html">Creation of the interpolation Grid</a>
    </li>
    <li>
      <a href="../articles/networks_intercomparison.html">Networks Intercomparison</a>
    </li>
    <li>
      <a href="../articles/presentation-agromet-project.html">Presentation of the Agromet Project</a>
    </li>
    <li>
      <a href="../articles/spatialization_example.html">A simple spatialization example using agrometeoR</a>
    </li>
    <li>
      <a href="../articles/two_years_benchmark.html">a 2 years benchmark</a>
    </li>
    <li>
      <a href="../articles/using_packrat.html">Using packrat</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../tutorials/presentation.html">FOSS4GBXL2018</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pokyah/agrometeoR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Creation of the interpolation Grid</h1>
                        <h4 class="author">Thomas Goossens</h4>
            
            <h4 class="date">11/28/2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pokyah/agrometeoR/blob/master/vignettes/interpolation_grid_creation.Rmd"><code>vignettes/interpolation_grid_creation.Rmd</code></a></small>
      <div class="hidden name"><code>interpolation_grid_creation.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The produced dataset will be injected into the postgres DB. The incagrid for Wallonia has been built from data provided by RMI. Like all the other datasets of the package, the code used to generate the grid is available under ./data-raw</p>
</div>
<div id="loading-the-grid-points" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-the-grid-points" class="anchor"></a>loading the grid points</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this is generated in data-raw/makeData.R and uses raw data provided by RMI</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(grid.sf)
grid.sf =<span class="st"> </span>grid.sf[<span class="st">"px"</span>]
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(grid.sf)</code></pre></div>
<pre><code>## Simple feature collection with 6 features and 1 field
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 550013.6 ymin: 665990 xmax: 554013.6 ymax: 666990
## epsg (SRID):    3812
## proj4string:    +proj=lcc +lat_1=49.83333333333334 +lat_2=51.16666666666666 +lat_0=50.797815 +lon_0=4.359215833333333 +x_0=649328 +y_0=665262 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
##         px                geometry
## 155 164266 POINT (552013.6 666990)
## 156 164267 POINT (553013.6 666990)
## 157 164268 POINT (554013.6 666990)
## 237 164865 POINT (550013.6 665990)
## 238 164866 POINT (551013.6 665990)
## 239 164867 POINT (552013.6 665990)</code></pre>
<p>We see that this <code>grid.sf</code> dataset contains the RMI <code>px</code> reference and the location of the grid points stored in the geometry attribute.</p>
<p>We will now inject the static explanatory variables <code>aspect</code>, <code>slope</code> and <code>elevation</code></p>
</div>
<div id="adding-explanatory-variables-to-the-grid" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-explanatory-variables-to-the-grid" class="anchor"></a>adding explanatory variables to the grid</h2>
<p>The explanatory static variabels are stored into the <code>grid.df</code> dataset. It also contains the <code>px</code> attribute that will allow us to make the join with the <code>grid.sf</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># loading the explanatroy var dataset</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"grid.df"</span>)
<span class="co"># removing X and Y cols</span>
grid.df =<span class="st"> </span>grid.df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)
<span class="co"># excerpt of the data </span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(grid.df)</code></pre></div>
<pre><code>##       px elevation      slope   aspect Agricultural_areas
## 1 161260  44.22828 0.01630801 4.131956          31.089247
## 2 161261  52.99506 0.02571558 2.808717          36.421557
## 3 161262  53.90875 0.04532333 1.553789          37.587495
## 4 161263  48.52546 0.01811805 3.178955          81.180172
## 5 161264  48.91750 0.02418184 3.826779          19.002174
## 6 161449  83.96607 0.02598631 2.169279           3.312782
##   Artificials_surfaces    Forest Herbaceous_vegetation
## 1             13.19809  8.980372              8.951741
## 2              0.00000 39.184419             22.347962
## 3              0.00000 49.111040             13.255778
## 4              0.00000  0.000000             18.774141
## 5             49.35525  0.000000             27.040626
## 6             57.84170  0.000000              0.000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># joining to grid.sf</span>
grid.sf =<span class="st"> </span>grid.sf <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(grid.df, <span class="dt">by =</span> <span class="st">"px"</span>)
<span class="co"># excerpt of the data </span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(grid.sf)</code></pre></div>
<pre><code>## Simple feature collection with 6 features and 8 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 550013.6 ymin: 665990 xmax: 554013.6 ymax: 666990
## epsg (SRID):    3812
## proj4string:    +proj=lcc +lat_1=49.83333333333334 +lat_2=51.16666666666666 +lat_0=50.797815 +lon_0=4.359215833333333 +x_0=649328 +y_0=665262 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
##       px elevation       slope   aspect Agricultural_areas
## 1 164266  17.91418 0.013484839 3.086932           80.07790
## 2 164267  18.14169 0.001938204 2.224847           78.06777
## 3 164268  18.83645 0.009254794 4.023337           83.34019
## 4 164865  19.88416 0.007572229 1.719723           96.17199
## 5 164866  17.56914 0.005303794 3.216073           30.83748
## 6 164867  17.48555 0.006535970 3.834256           85.14979
##   Artificials_surfaces Forest Herbaceous_vegetation
## 1             0.000000      0              19.87641
## 2             0.000000      0              21.88654
## 3             0.000000      0              16.61413
## 4             3.782325      0               0.00000
## 5            27.236174      0              41.88066
## 6             0.000000      0              14.80453
##                  geometry
## 1 POINT (552013.6 666990)
## 2 POINT (553013.6 666990)
## 3 POINT (554013.6 666990)
## 4 POINT (550013.6 665990)
## 5 POINT (551013.6 665990)
## 6 POINT (552013.6 665990)</code></pre>
</div>
<div id="writing-to-file" class="section level2">
<h2 class="hasAnchor">
<a href="#writing-to-file" class="anchor"></a>Writing to file</h2>
<p>We can now write our spatial object that contains the explanatory variables to a geojson file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># transforming to proj EPSG = 4326 (geojson standard)</span>
grid.sf =<span class="st"> </span>sf<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/st_transform">st_transform</a></span>(grid.sf, <span class="dv">4326</span>)
sf<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/st_write">st_write</a></span>(<span class="dt">obj =</span> grid.sf, <span class="dt">dsn =</span> <span class="st">"incagridExplVars.geojson"</span>)</code></pre></div>
<pre><code>## Writing layer `incagridExplVars' to data source `incagridExplVars.geojson' using driver `GeoJSON'
## features:       52195
## fields:         8
## geometry type:  Point</code></pre>
<p>You can download this geojson file <a href="https://github.com/pokyah/agrometeoR/blob/master/vignettes/incagridExplVars.geojson">here</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#loading-the-grid-points">loading the grid points</a></li>
      <li><a href="#adding-explanatory-variables-to-the-grid">adding explanatory variables to the grid</a></li>
      <li><a href="#writing-to-file">Writing to file</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Thomas Goossens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
